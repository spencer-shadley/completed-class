# 6.2 - Advanced AJAX

## Overview

In this class, students will be building upon their knowledge of AJAX to retrieve data via the OMDb api and display data onto an HTML page.

`Summary: Complete activities 5-11 in Unit 6`

- Use the slideshow as an initial starting point for your conversation on APIs. Make sure that students see the power of APIs and understand how APIs provide a link between front-end (what they've learned so far) and backend (what they will soon be learning).

- Today's activities will feel pretty challenging and confusing to the majority of your students. Use your best judgment and adjust as necessary. If you need to cut the Bands In Town exercise by all means do so.

- Today's Weather in Bujumbura Activity will require students to use an API key from [OpenWeatherMap API](http://openweathermap.org/api). Please have them apply for one before class starts in order to have it approved and activated in time for the activity.

## Learning Objectives

- To solidify understanding of APIs, JSONs, and their roles in full-stack web development

- To increase comfort working with APIs and AJAX calls in data-rich applications

### Instructor Do: API and AJAX Slide Show

- 630-42 (12 min)

* Begin class by welcoming students and asking if there are any lingering questions.

* Then open up the slide deck [06-2 Advanced AJAX](https://docs.google.com/presentation/d/1AMZW0G8cYnEdqeIMZMoNUQRsM1PVgykP7afZ_31wJE4/edit?usp=sharing) and begin presenting the slides. Encourage students to answer questions and ask questions. Draw upon your own insight regarding APIs to try and further solidify their understanding of the role APIs play in web development. Show the videos included in the slide deck when appropriate.

* Just be sure to keep focused and stay on track of time!

### Students Do: 05-Bujumbura

- 642-57 (15 min)

### Instructor Do: Review 05-Bujumbura

- 657-702 (5 min)

  - we retrieved an API key from the [OpenWeatherMap API](http://openweathermap.org/api) site.

  - we then used this APIKey as part of our `queryURL` along with the city parameter (in this case Bujumbura)

    - we then passed this `queryURL` into our AJAX call.

  - Then inside the `.then` method of the AJAX call, we are capturing data inside of a variable called `response`.

  - And that we parse this `response` JSON to retrieve individual properties like `wind.speed`, `main.humidity`, and `main.temp`. This was then dumped using jQuery into the HTML.

  - Finally, point out that when it came to the bonus we converted the temperature value by incorporating the Kelvin data into a formulaic conversion.

    - Ask students how you would recycle the code shown to instead find the weather in `London`. (Answer: Just change the `queryURL`)

- Ask students why all of the code needed be inside the `.then` function. (Answer: Otherwise, we might not have data yet.)

### Instructor Do: 10-WorkingMovieApp

- 702-07 (5 min)

* Today's class we will be working towards building this

* In demonstrating this application:

  - Click on the existing buttons to show that movies are displayed.

  - Create a new movie to the listing, point out that a button was generated dynamically, and that this button becomes a clickable AJAX caller of its own.

### Students Do: 06-MovieJSONDump

- 707-17 (10 min)

* Retrieve movie as JSON. This movie is then appended directly into the HTML as is.

### Instructor Do: Review 06-MovieJSONDump

- 717-22 (5 min)

* Review the JSON Dump activity. In your discussion be sure to point out:

  - The standard `AJAX` syntax of capturing both `queryURL` and `GET` method.

  - Point out the use of `JSON.stringify(response)` for converting the retrieved JSON into a string that can be put placed into text.

### Students Do: 07-MovieButtonLayout

- 722-47 (25 min)

### Instructor Do: Review 07-MovieButtonLayout

- 747-57 (10 min)

  - The `renderButtons` function is looping through the `movies` array and creating a jQuery element for each.

  - Pay special attention to the syntax for jQuery's creation of dynamic elements.

  - Point out that the `.on("click")` event tied to the button is what triggers re-rendering of the movies array

  - Ask students why the `#buttons-view` needed to be emptied in the `renderButtons` function(Answer: otherwise content will get replicated each time you click a button).

### Students Do: 08-LogMovieName and 09-ClickJSON

- 757-817 (20 min)

- [08-LogMovieName]

  - Point out that, with this app, clicking any of the buttons &mdash; either new or old &mdash; will trigger an alert message listing out the movie name.

- [09-ClickJSON]

  - Point out that, with this app, clicking any of the buttons &mdash; either new or old &mdash; will cause a JSON dump of the movie to appear. Be sure to point out that the code works for both the original buttons _and_ the newly created buttons.

### Instructor Do: Review 08-LogMovieName and 09-ClickJSON

- 817-27 (10 min)

* Review the solution provided in [08-LogMovieName/Solved].

* Review the solution to the last activity provided in [09-ClickJSON/Solved/click-json-solved.html].

  - Be sure to emphasize how we used the same `stringify` method in both solutions.

* In your discussion, be sure to point out

  - How we used data attributes to retrieve the "name" of each movie;

    - Also point out how we used an alternative `.on("click")` event. Instead of using an `.on("click")` event associated with our buttons, we created one that was associated with the `document`. This was necessary to ensure that the dynamically created elements were bound to jQuery.

  - Demonstrate how the app would function with both sets of event syntax.

### BREAK

- (15 min)

### Students Do: Complete Working Movie App

- (25 min)

- Finally, open the working file: [10-WorkingMovieApp/Solved/working-movie-app-solved.html] in your browser and demonstrate what the final application will look like.

- Then slack out the following folder and instructions.

- **Folder:**

  - [10-WorkingMovieApp/Unsolved]

- **Instructions:**

  - Using either version of the starter code provided to you, complete the application so that various snippets of information about your movie are displayed underneath. As a suggestion, display at least each of the following:

    - Movie Poster

    - Rating

    - Release Date

    - Plot

### Instructor Do: Review Activity

- (5 min)

* Review the final application's code as shown in [10-WorkingMovieApp/Solved].

* Point out how this application's code basically consists of an AJAX call which retrieves data from the OMDb API, parses it, then displays it inside of an HTML element.

### Students Do: Bands In Town App (20 min - OPTIONAL)

- If you have any extra time, then proceed with the Bands In Town application.

- Slack out the following folder and instructions to students.

- **Folder:**

  - [11-BandsInTownApp/Unsolved]

- **Instructions:**

  - Using the starter code provided to you, complete the application such that your code will search the Bands In Town API for the artist specified in the search box.

  - Bands in Town is a service for finding out when and where bands and artists are scheduled to tour.

  - Information on how to use query the Bands In Town API can be found [here](https://app.swaggerhub.com/apis/Bandsintown/PublicAPI/3.0.0)

  - Note: This is a free public API and you will not need to sign up for anything.

  - **HINT:** Scroll down the API docs and study the examples. See if you can figure out how to query for an artist's information. You will need to use the `/artists/{artistname} endpoint`.

  - **HINT:** The `app_id` parameter described in the docs is required, but can be set to anything you wish.

### Instructor Do: Review Bands In Town App (5 min - OPTIONAL)

- Review the Bands In Town code. Be sure to point out how the `app_id` is required but can be anything, and point out how the logged JSON response relates to the new HTML on the page.

![6-BandsInTown_2](Images/6-BandsInTown-2.png)
