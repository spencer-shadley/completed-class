<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Drill Solution</title>
  </head>
  <body>
    <script>
      // sum all the numbers in a loop
      // divide by the total number of items
      function average1(numbers) {
        if (!isValidInput(numbers)) {
          return NaN;
        }

        var sum = 0;
        for (var i = 0; i < numbers.length; ++i) {
          sum += numbers[i];
        }
        return sum / numbers.length;
      }

      // same as average1 but use the reduce function
      function average2(numbers) {
        if (!isValidInput(numbers)) {
          return NaN;
        }

        var sum = numbers.reduce(function(previous, current) {
          return (current += previous);
        });
        return sum / numbers.length;
      }

      // same as average2 but inline the division
      function average3(numbers) {
        if (!isValidInput(numbers)) {
          return NaN;
        }

        return numbers.reduce(function(previous, current) {
          return (current += previous / numbers.length);
        });
      }

      // helper function
      function isValidInput(numbers) {
        if (!Array.isArray(numbers) || numbers.length === 0) {
          console.error('Input is not an array', numbers);
          return false;
        }
        return true;
      }

      // let's test it!
      function runTests(testName, callbackFunction) {
        var testCases = [
          {
            input: [5, 3, 7],
            expected: 5
          },
          {
            input: [4, 4, 4, 4, 4, 4, 4, 4, 4],
            expected: 4
          },
          {
            input: [3, 54, 9, 233],
            expected: 74.75
          },
          {
            input: [-4, 3, 78],
            expected: 25.666666666666668
          },
          {
            input: [4.3, 6.7543, 32],
            expected: 14.351433333333333
          },
          {
            input: [],
            expected: NaN
          },
          {
            input: null,
            expected: NaN
          },
          {
            input: undefined,
            expected: NaN
          },
          {
            input: "I'm going to pass in a string because I can!",
            expected: NaN
          }
        ];

        var results = [];
        testCases.forEach(function(testCase) {
          var actual = callbackFunction(testCase.input);
          results.push({
            input: testCase.input,
            expected: testCase.expected,
            actual: actual,
            isCorrect:
              // NaN is not equal to NaN
              // this is the only value in JavaScript that is not equal to itself
              (Number.isNaN(this.actual) && Number.isNaN(this.expected)) ||
              this.expected === this.actual
          });
        });
        console.log(testName);
        console.table(results);
      }
      runTests('average1', average1);
      runTests('average2', average2);
      runTests('average3', average3);
    </script>
  </body>
</html>
