# 6.2 Lesson Plan - Advanced AJAX (6:30 PM)

## Overview

In this class, students will be building upon their knowledge of AJAX to retrieve data via the OMDb api and display data onto an HTML page.

## Instructor Notes

- Today's Weather in Bujumbura Activity will require students to use an API key from [OpenWeatherMap API](http://openweathermap.org/api). Please have them apply for one before class starts in order to have it approved and activated in time for the activity.

### Instructor Do: API and AJAX Slide Show

- 630-42 (12 min)

- Begin class by welcoming students and asking if there are any lingering questions.

- Then open up the slide deck [06-2 Advanced AJAX](https://docs.google.com/presentation/d/1AMZW0G8cYnEdqeIMZMoNUQRsM1PVgykP7afZ_31wJE4/edit?usp=sharing) and begin presenting the slides. Encourage students to answer questions and ask questions. Draw upon your own insight regarding APIs to try and further solidify their understanding of the role APIs play in web development. Show the videos included in the slide deck when appropriate.

- Just be sure to keep focused and stay on track of time!

### Students Do: The Weather in Bujumbura

- 642-57 (15 min)

- Then open the file [05-Bujumbura/Solved/bujumbura-solved.html].

![1-Bujumbura_1](Images/1-Bujumbura_1.png)

### Instructor Do: Review Activity

- 657-702 (5 min)

- Open the file [05-Bujumbura/Solved/bujumbura-solved.html] in your editor and walk students through the code.

- During your explanation, be sure to point out each of the following:

  - That we retrieved an API key from the [OpenWeatherMap API](http://openweathermap.org/api) site.

  - That we then used this APIKey as part of our `queryURL` along with the city parameter (in this case Bujumbura)

    ![2-Bujumbura_2](Images/1-Bujumbura_2.png)

  - That we then passed this `queryURL` into our AJAX call.

  - Then inside the `.then` method of the AJAX call, we are capturing data inside of a variable called `response`.

  - And that we parse this `response` JSON to retrieve individual properties like `wind.speed`, `main.humidity`, and `main.temp`. This was then dumped using jQuery into the HTML.

  - Finally, point out that when it came to the bonus we converted the temperature value by incorporating the Kelvin data into a formulaic conversion.

    ![3-Bujumbura_3](Images/1-Bujumbura_3.png)

* Ask students how you would recycle the code shown to instead find the weather in `London`. (Answer: Just change the `queryURL`)

* Ask students why all of the code needed be inside the `.then` function. (Answer: Otherwise, we might not have data yet.)

### Instructor Do: Working Movie App Demo

- 702-07 (5 min)

- Next open the file [10-WorkingMovieApp/Solved/working-movie-app-solved.html] in your browser. Let students know that in today's class we will be working towards building this.

- In demonstrating this application:

  - Click on the existing buttons to show that movies are displayed.

  - Create a new movie to the listing, point out that a button was generated dynamically, and that this button becomes a clickable AJAX caller of its own.

### Students Do: Movie App JSON Dump

- 707-17 (10 min)

- Then open the file [06-MovieJSONDump/Solved/movie-json-dump-solution.html] to retrieve movie in the form of a JSON. This movie is then appended directly into the HTML as is.

### Instructor Do: Review Activity

- 707-12 (5 min)

- Review the JSON Dump activity. In your discussion be sure to point out:

  - The standard `AJAX` syntax of capturing both `queryURL` and `GET` method.

  - Point out the use of `JSON.stringify(response)` for converting the retrieved JSON into a string that can be put placed into text.

    ![2-JSONDump_1](Images/2-JSONDump_1.png)

### Students Do: Dynamic Movie Button Layout

- 712-37 (25 min)

- Next demonstrate the file `movie-button-layout-solved.html` in `07-MovieButtonLayout` in your browser. Point out that this application allows users to create new buttons dynamically when a user clicks `Add a Movie Yo`.

### Instructor Do: Review Activity

- 737-47 (10 min)

- Next, review the solution provided in [07-MovieButtonLayout/Solved/movie-button-layout-solved.html]. In discussing the solution be sure to point out:

  - That the `renderButtons` function is looping through the `movies` array and creating a jQuery element for each.

  - Pay special attention to the syntax for jQuery's creation of dynamic elements.

  - Point out that the `.on("click")` event tied to the button is what triggers re-rendering of the movies array

  - Ask students why the `#buttons-view` needed to be emptied in the `renderButtons` function(Answer: otherwise content will get replicated each time you click a button).

### Students Do: Log Movie JSON & Click JSON Data Attribute

- 747-807 (20 min)

- Demonstrate [08-LogMovieName/Solved/log-movie-name-solved.html] in the browser.

  - Point out that, with this app, clicking any of the buttons &mdash; either new or old &mdash; will trigger an alert message listing out the movie name.

- Demonstrate [09-ClickJSON/Solved/click-json-solved.html] in the browser.

  - Point out that, with this app, clicking any of the buttons &mdash; either new or old &mdash; will cause a JSON dump of the movie to appear. Be sure to point out that the code works for both the original buttons _and_ the newly created buttons.

### Instructor Do: Review Activity

- 807-17 (10 min)

- Review the solution provided in [08-LogMovieName/Solved].

- Review the solution to the last activity provided in [09-ClickJSON/Solved/click-json-solved.html].

  - Be sure to emphasize how we used the same `stringify` method in both solutions.

- In your discussion, be sure to point out

  - How we used data attributes to retrieve the "name" of each movie;

    ![4-ConsoleLog_1](Images/4-ConsoleLog_1.png)

- Also point out how we used an alternative `.on("click")` event. Instead of using an `.on("click")` event associated with our buttons, we created one that was associated with the `document`. This was necessary to ensure that the dynamically created elements were bound to jQuery.

  - Demonstrate how the app would function with both sets of event syntax.

    ![4-ConsoleLog_2](Images/4-ConsoleLog_2.png)

### BREAK

817-32 (15 min)

### Students Do: Complete Working Movie App

- 832-57 (25 min)

- Finally, open the working file: [10-WorkingMovieApp/Solved/working-movie-app-solved.html] in your browser and demonstrate what the final application will look like.

### Instructor Do: Review Activity

- 857-902 (5 min)

- Review the final application's code as shown in [10-WorkingMovieApp/Solved].

- Point out how this application's code basically consists of an AJAX call which retrieves data from the OMDb API, parses it, then displays it inside of an HTML element.

![5-WorkingApp_1](Images/5-WorkingApp_1.png)

![5-WorkingApp_2](Images/5-WorkingApp_2.png)

### Students Do: 11-BandsInTownApp (optional)

- 902-22 (20 min)

- If you have any extra time, then proceed with the Bands In Town application.

- Slack out the following folder and instructions to students.

- Today's activities will feel pretty challenging and confusing to the majority of your students. Use your best judgment and adjust as necessary. If you need to cut the Bands In Town exercise by all means do so. Offer ample support and let students know that things will "click" eventually -- even if it doesn't quite click just yet.

### Instructor Do: Review Bands In Town App (optional)

- 922-27 (5 min)

- Review the Bands In Town code. Be sure to point out how the `app_id` is required but can be anything, and point out how the logged JSON response relates to the new HTML on the page.
