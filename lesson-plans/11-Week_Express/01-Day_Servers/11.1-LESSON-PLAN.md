# 11.1 - Intro to Node Servers

### Slides

- 630-55 (25 min)

### Ins: 01-FirstServer

- 655-710 (15 min)

- create a server

- live code

- `http` is part of the node standard library

- port `80` is the http default port. `8080` is a common alternative because it's two `80`s and is outside the restricted range of ports (`1-1023`)

  - `110` and `995` are used to receive email, for example
  - `https` uses `443`

  - think of a port like a port for boats

    - every boat has to specify a port to dock in
    - the boat has a "berth number" - unique number to identify the boat
    - "beth" + port number = who, what and where for the boat
    - berth = IP addresses, port = port
    - cargo in boat is the payload

- Code order

  - http import
  - create server
  - handleRequest with just a log
  - listen
  - run it
  - go to http://localhost
  - go to http://localhost:8080
  - add a response (response.end must always be called) - include request.url
  - add an HTML response

### Stu: 02-Two-Servers

- 710-30 (20 min)

- students try out creating not one but two servers

### Ins: Review

- 730-35 (5 min)

- Demo solved version - http://localhost:7000 vs http://localhost:7500

- Basically there are two servers

  - different port, listeners, functions

### Break

- 735-50 (15 min)

### Ins: 03-Portfolio

- 750-800 (10 min)

- URL parsing and routing

- In the next class we will introduce express to make the syntax simpler. Make sure to understand the concepts here

- Show in chrome dev tools the response headers

- Demo in POSTMAN

### Stu: Discuss Portfolio

- 805-15 (10 min)

- Explain the code we just demo'd to each other in groups

### Ins: 04-Serving-HTML

- 810-35 (15 min)

- Use `fs` to serve an actual HTML file

- For 2 minutes let the students look over the file themselves

### Stu: Discuss 04-Serving-HTML

- 835-40 (5 min)

- Have students discuss the code with one another before asking them to re-explain it back to you

- Can be skipped if short on time

### Stu: 05-Serve-Favorites

- 840-910 (30 min)

- Next, run the `server.js` file found in `05-Serve-Favorites/Solved`. Visit each of the routes in that file (i.e. `localhost:8080/food`, `localhost:8080/movies`, etc.). Point out how the contents of the page changes each time.

### Ins: Review

- Open up the `server.js` file found in `05-Serve-Favorites/Solved` and review the code in this example. During your discussion, be sure to point out:

  - How we created the basic skeleton of a Node server (requiring: `http` and the port number)

  - How we set up a listener to initiate the server's handling of requests.

  - Created a function `handleRequest` which takes in a request URL, parses it, then relays the user to the correct page.

    - This solution contains a lot of repeated code. Ask your students if they have any suggestions how we might refactor this. Then open `server-bonus.js` and point out how we implement just one `fs.readFile()` command by passing in a filePath into a `renderHTML` function.

### Ins: 06-Request-Methods

- 910-20 (10 min)

- Up until now, students have just been exposed to GET requests. (They may not even realize it yet, but all the URL visits they've made thus far have been GET requests). In this activity, we will very briefly introduce them to other HTTP methods.

- Open `06-Request-Methods/server.js` in your editor.

- Briefly run through the code and explain that this app is going to log the type of request it receives, along with any information that was sent with the request.

- Have students download the application [Postman](https://www.getpostman.com/). If you've never worked with Postman before, it's a simple application interface for performing HTTP request (GET, POST, PUT, DELETE, and more).

- Run the server and use Postman to make different types of requests. Show the students how every time a request is made, it is logged in the server's console.

- Let the students know that the body of Postman requests must be sent in `raw`, and GET requests cannot have a body in Postman

- Alternatively you can use CURL

  - `curl -i -H "Accept: application/json" -X GET -d "firstName=james" http://localhost:8080`
  - `curl -i -H "Accept: application/json" -X POST -d "firstName=james" http://localhost:8080`
  - `curl -i -H "Accept: application/json" -X PUT -d "firstName=james" http://localhost:8080`
  - `curl -i -H "Accept: application/json" -X DELETE -d "firstName=james" http://localhost:8080`

- Slack students a copy of this server code: `06-Request-Methods/server.js`.

- Let students know that we will be fleshing out this concept over the course of the week.

### Ins: Introduce Friend Finder Homework

- 920-25 (5 min)

- Finally, end the class by opening the solution to the Homework (FriendFinder). Run the application using `node server.js` then visit `localhost`. Walk students through the basic gist of the application, describing it as a type of dating application or compatibility test. In essence, the application saves each user's survey responses in the database, then compares the responses against everyone in the database to identify the best match.

- Stress that students should deploy their assignment as early as possible and ask for help if they run into issues. Explain that a non-deployed assignment will take a grade hit and won't help students professionally.

### Small Time Left - Review Class

- 925-30 (5 min)

- Ask:

  - What is a web server?
  - What is the difference between a `request` and a `response`.
  - What are some examples of web servers we use every day?
  - What are the different types of request methods, and how are they used?

- Google Express

### Large Time Left - bonus-1-POST-method

- (20 min)

- In this exercise, students will create a server that will accept `POST` requests.

### BONUS: Review

- (10 min)

- Open up the `server.js` file found in `07-POST-Method/Solved` and go over to the solution with students.

- In your discussion:

  - Lightly discuss the concept of a `POST` route, specifically mentioning how POST routes are effectively endpoints that client-side code can use to send data to the server.

  - If you have time, take a few moments to show students how to test this POST route using POSTMan.
