# 12.3 - My-Massive-SQL

## Overview

- **Extra Resources:** Send out the following link before or after class and encourage students to tackle the two MySQL questions in [Whiteboarding Overview and Questions](https://coding-bootcamp-whiteboarding-algorithms.readthedocs-hosted.com/en/latest/). This was given with the course pre-work but after this week, students should be able to accomplish those questions.

### Optional - MySQL Quiz (10 minutes)

If your class is struggling with MySQL fundamentals (Connecting, creating schemas, etc.) spend 10 minutes doing this quick warm-up activity: `0-MySQL PopQuiz` in `11-popQuiz/README.md`.

### Ins: Introduction to Big Data

- 10-15 (15 min)

- This is an easier day which reviews the past week

- Importing data + review

- Big data - only difference is the amount of data

- slidedeck

### Stu: 12-Top5000Schema (Part 1)

- 1015-25 (10 min)

- `TopSongs.csv` contains 5000 lines of music data

- The column names are in the hints

- In MySQL we can create schemas to avoid having to setup a database/table on every new machine

- We also can add `seeds.sql` files to save statements used to insert data into the tables

### Ins: Review

- 1025-1030 (5 min)

- Just review the columns that people want to make (name, type, size, nullable)

- `DECIMAL(X, Y)` is a decimal with X digits of precision (1-38 allowed), Y of them used for the decimal digits

### Stu: Preparing the Database (Part 2)

- 1030-50 (20 min)

- Create the actual queries for it

### Ins: Review

- 1050-11 (10 min)

- Show the actual query

### Ins: Importing Data Demo

- 11-10 (10 min)

- Show that `SELECT` is empty

- Click the Import from the table view

  - If it says "Not responding" it's probably lying

- Might need to click "Apply" in the bottom right

- Run the `SELECT` to show the full data now

### Stu: 13-Top5000Code

- 1110-1140 (30 min)

- Import the data set and then build a Node app which interacts with it

- Tell the students a break is up next and then review

### BREAK

- 1140-1220 (40 min)

### Ins: Review

- 1230-45 (15 min)

- Open up `TopSongsCode.js` in `13-Top5000Code` within your editor and go over it with the class, going over the steps we used to create the database and import our table-data into it once more as well so that your students are 100% clear on how this process works.

- We used some new SQL commands within our code which your students may not have found unless they decided to look online. These include the `GROUP BY` and `BETWEEN`statements.

  - `GROUP BY` groups elements with shared values together and then allows us to use the `HAVING count(*) >1` statement to determine if there are multiples within that group.

  - `BETWEEN ? AND ?` allows us to select information between a specific range.

- Briefly explain the notion of **indexes**.

  - Explain that evaluating certain queries, such as `WHERE` and `BETWEEN` queries, requires MySQL to examine a large number of rows.

  - Explain that this generally doesn't become a problem until our database grows very large in size, but it's something to think about when designing a table structure or when identifying that certain types of queries will be used more than others.

  - Explain that instructing MySQL to use certain columns as _indexes_ helps speed up the evaluation of such queries by limiting the number of records MySQL has to examine.

    - Rather than read a table row-by-row to execute a `WHERE` clause, an index takes data from a column in a table, and stores it alphabetically in a separate location called an index. Then when the data needs to be accessed, it's searched for it in this shorter list (the index) and then looks at the row(s) the data comes from when a match is found.

    - Explain that indexes also improve the performance of certain `JOIN` and `BETWEEN` clauses.

  - Explain that we can manually set arbitrary columns as indexes using the `ADD INDEX` statement.

    - Briefly demonstrate the syntax for this command on-screen: `ALTER TABLE`top5000`ADD INDEX` song `(`song`)`.

    - The following query would take advantage of the index:

    ```sql
    SELECT * from top5000 WHERE song = 'freebird'
    ```

  - Explain that MySQL automatically creates an index associated with a table's primary key, so there's no need to create an index for that.

  - Explain that one determines the appropriate indexes for a table on a case-by-case basis, and that we won't dive into the guidelines just now.

    - Emphasize again that indexes won't make a demonstrable difference for databases of the size we'll work with in class, but it's helpful to understand the concept as students are likely to encounter them in large databases they'll meet on the job.

  - If any time remains go over [this article explaining MySQL indexes](https://atech.blog/viaduct/mysql-indexes-primer) as a class or otherwise suggest students read over it when they have a chance later.

### Stu: Two Tables Are Better Than One

- 1245-145 (60 min)

- Explain that, when dealing with big databases, it is very likely that you will have to work with two or more datasets that are related, but which have some degree of separation between them. In this case we have a table of the top 5000 songs and a table of the top 3000 albums.

- Emphasize the relationship between databases and tables: Tables live **in** databasesâ€”i.e., databases consist of tables.

  - Alternatively: A **table** stores information in rows and columns. A **database** is a collection of related tables.

- Take a moment to answer questions, and then slack out the following activity.

- **Files**

  - `TopAlbums.csv` in `14-TwoTables`

- **Instructions**

  - Your assignment is to take these two large sets of data and come up with a method to join them together in order to figure out if a given artist's song and album made it into the charts at the time of their release.

    - HINT: This can be done in a couple different ways using external data as well, but you do have all of the data you need within your database to find the correlations. Give your methods some though before having to rely upon external info.

    - HINT: Remember that MySQL has the ability to combine two or more tables together so long as they share equivalent data. What data is similar between the two lists?

  - Once you have managed to successfully bring the two datasets together, start making queries like those you made earlier to this new table as well.

### Everyone Do: Going Over Two Tables

- 145-2 (15 min)

- Open up `TopSongsAndAlbumsCode.js` in `14-TwoTables` and go over the function which was added to the bottom. The query down there is far longer and far more confusing than the rest, so go over it step-by-step in great detail so that everyone in your class understands what it does.

- Once it seems everyone has an idea of how that code works, ask a few brave souls to come up to the front to share their additions to the code with the class. Let them describe their code and field the questions as well, only jumping in when you feel the need to.
