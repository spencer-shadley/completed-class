# 12.2 - Node Gets a SQL

## Overview

While the first class of the week took us away from JavaScript and Node for a tiny bit, today's class combines the old with the new in a way that shows just how powerful a MySQL server can be. With that being said, be on the lookout for small errors in syntax over the course of today's lesson. MySQL is VERY particular about the syntax that is used and this can lead to stress.

## Instructor's Notes

**IMPORTANT**: If you are using MySQL 8, you will need to have your class run the following query in the MySQL Workbench

```sql
ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'yourRootPassword'
```

Failure to do so will result in

```sh
Error: ER_NOT_SUPPORTED_AUTH_MODE: Client does not support authentication protocol requested by server; consider upgrading MySQL client
```

Change password with:

```sql
ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewPassword';
```

## Learning Objectives

- To create a connection to a MySQL database using Node

- To create, read, update, and delete data from a MySQL database using Node

- To work with a group in taking a basic concept for a server side application and creating a working prototype for that application within a given time frame

### Ins: Welcome Class

- 630-32 (2 min)

### Ins: 06-iceCreamWithConnection

- 632-37 (5 min)

- connects to mysql with Node

- live code

- will have an error, create DB with:

```sql
CREATE database ice_creamDB;
```

### Stu: 06-iceCreamWithConnection

- 637-47 (10 min)

- try connecting to SQL using Node

### Ins: 07-iceCreamReadData

- 647-57 (10 min)

- Base from `06-iceCreamWithConnection`

```js
connection.connect(err => {
  if (err) throw err;
  console.log(`connected as id ${connection.threadId}`);
  selectAll();
});

function selectAll() {
  connection.query('SELECT * FROM products', (err, res) => {
    if (err) throw err;
    console.log(res);
    connection.end();
  });
}
```

- Note the ordering and that the query must be within the callback (likely error source)

- the output will say `RowDataPacket` (the classname, we can ignore this)

### Stu: 08-playlistRead

- 657-712 (15 min)

- Practice creating a DB with SQL and then querying in Node

### Ins: Review

- 712-22 (10 min)

- The `?` will be replaced with the contents of the array

### Ins: 09-iceCreamCRUD

- 722-37 (15 min)

```sql
C - CREATE - INSERT INTO pets (name, type, age) VALUES ("fido", "dog", 3);
R - READ   - SELECT * FROM pets;
U - UPDATE - UPDATE pets SET name="under dog" WHERE type = "dog";
D - DELETE - DELETE FROM pets WHERE type = "mouse";
```

- live code the activity

  - keys of object are the columns

- updating data only needs the addition of `WHERE`

- delete is like read except it include a `WHERE` and says `DELETE`

### Stu: 09-iceCreamCRUD

- 737-57 (20 min)

### BREAK

- 757-812 (15 min)

### Groups Do: Great-Bay

- 812-912 (60 min)

- When everyone is back from break, split them up into groups of three or four and then slack out the following instructions...

- **Instructions**

  - Within your groups you are going to be creating a Node application called "Great-Bay" which allows users to create and bid on assorted items, tasks, jobs, or projects.

  - The basic application is fairly simple: Upon loading up the program, the user is prompted on whether they would like to "POST AN ITEM" or "BID ON AN ITEM"

    - If the user selects "POST AN ITEM" they are prompted for an assortment of information regarding the item and then that information is added to the database so that others can bid on it

    - If the user selects "BID ON AN ITEM" they are shown a list of all available items and then are prompted to select what they would like to bid on. The console then asks them how much they would like to bid, and their bid is compared to the previous highest bid. If their bid is higher, inform the user of their success and replace the previous bid with the new one. If their bid is lower (or equal), inform the user of their failure and boot them back to the selection screen.

  - Once your group has put together the basic application, it's time to test your collective skills on some additional functionality, or "addons". Remember to take into consideration the amount of time you have been given when choosing what addons you would like to tackle.

    - Create a sign up and login system that prompts users for a username and password upon loading up the app. **Do not worry about setting up a truly secure database if you choose to tackle this addon. Just worry about building working sign up and login features.**

    - Create a system on the "POST AN ITEM" which allows users to look at the auctions they have created. On this screen they can add new auctions, modify previous auctions, or close bidding on an auction.

    - Create a system which allows users to view all of the auctions of which they are the leading bidder.

    - Create a third option on the main screen which allows administrators to modify the database as they see fit.

    - Create visually appealing tables. This means making dynamic console code and it is a lot harder than it might seem at first so do not think this one is so simple.

    - Create a search function that allows users to look through the database of available auctions to find those that share the specified keyword or username.

    - Get creative! There are a lot of addons to this app which you could create so feel free to work with your group to come up with something not listed above!

### Everyone Do: Share Your Work

- 912-32 (20 min)

- With any luck, the class has been able to tackle not only the basic assignment, but has also managed to put together a few different addons for the application which they can share with everyone else.

- Start out this part of the class by asking a group who feels confident in their code for the basic application and is confident that it works to slack it out and then walk the rest of the class through it. Make yourself available to answer questions the rest of the class might have regarding the group's code if there are any individuals who seem very confused.

- Next, start running through the list of addons we suggested above and see if there are any groups out there who are willing to share their solutions with the class.

- Finally, ask the class if there were any groups who went above and beyond to create their own addons for the application and have them share this code with the class as well.
