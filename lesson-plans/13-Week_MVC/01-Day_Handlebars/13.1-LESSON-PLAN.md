# 13.1 Lesson Plan: I Can Make an App with Some Handlebars

## Overview

Students will be diving into the basics of Handlebars today, a semantic templating language which can be used to link back-end javascript data to front-end HTML with relative ease.

- Before jumping into Handlebars, we will be going over how to send MySQL data from the back-end to the front-end. Depending upon how well this goes, you may or may not wish to review Express some more today and tackle Handlebars later in the week.

- Handlebars can seem daunting at first, but it is ultimately a very powerful templating tool which your students might find useful. Try to keep to a pace that your students seem comfortable learning, so as to make sure no one is left behind.

## Learning Objectives

- To send MySQL data from the back-end to the front-end using Express

- To understand semantic templating using Handlebars

- To understand the basic syntax for Handlebars-based web applications

- To create an Express connection to a front-end application which prints data to the screen using Handlebars

### Ins: Welcome Students and Introduce HW

- 630-35 (5 min)

### Stu: 01-ExpressCalculator

- 635-55 (20 min)

- Express app which supports routes for add, subtract, etc.

### Ins: Review

- 655-705 (10 min)

- live code

### Ins: 02-MagicalSchools

- 705-20 (15 min)

- Creates data in a database and then uses that data to generate HTML

- Run `schema.sql` in Workbench

- Run `magicSchools.js`

### Partners Do: 03-SeinfeldApp

- 720-40 (20 min)

- similar to harry potter, node app which reads db data and generates HTML

- demo the app (run `schema.sql` then the node app)

  - <http://localhost:3000/cast>
  - <http://localhost:3000/coolness-chart>
  - <http://localhost:3000/attitude-chart/relaxed>

### Ins: Review

- 740-55 (15 min)

- if time is available, live code for 15 minutes

- if time is not available, this can be 10 minutes

### Ins: SQL + HTML = Bad Idea

- 755-8 (5 min)

- Ask: What are some problems with this method of generating HTML? Why might we want to avoid this?

  - We have to write a lot of HTML inside JavaScript

  - we are mixing the view and core business logic

### BREAK

- 8-15 (15 min)

### Ins: 04-HandlebarsLunch

- 815-40 (25 min)

- TODO: recreate activity and live code this

- Describe template engine

  - use static template files in application
  - the template engine replaces variables in the template file with actual values, transforming the template to actual HTML

- `handlebars` is an extension of `mustache`

- Start at `server.js`

  - by default Express uses Jade (renamed to Pug) for its rendering engine

    - `app.set('view engine', 'handlebars');`

  - automatically creates a template file based on the `views` directory with the specified extension `handlebars`

  - specify a layout to use by default

- `layout` allows injecting into it with `{{{ stuff }}}` (triple renders as text, double escapes HTML)

  - `body` is the reserved `hook` handlebars will look for

- about `handlebars`

  - Expression example `<p>{{firstname}} {{lastname}}</p>`

    - path expression navigates an object using standard dot notation: `{{person.firstname}} {{person.lastname}}`

    - context using block helpers `#with` or `#each` which support `../` to go to parent's context

      ```js
      {{#each people}}
      {{../prefix}} {{firstname}}
      {{/each}}
      ```

- custom helpers

  ```js
  Handlebars.registerHelper('loud', function(aString) {
    return aString.toUpperCase();
  });

  {{firstname}} {{loud lastname}}
  ```

  - `this` context is received as the context

- blocks

  - `#X` starts a block `/X` ends it

  ```js
  {{#if condition}}
  condition is met
  {{ else }}
  {{/if}}
  ```

  - `this` is a handlebars keyword to reference the current context

  ```js
  {{#each anyArray}}
    {{this}}
  {{/each}}
  ```

- Partials

  - Shared templates

  ```js
  Handlebars.registerPartial(
    'person',
    '{{person.name}} is {{person.age}} years old.\n'
  );

  {{#each persons}}
  {{>person person=.}}
  {{/each}}
  ```

  - dynamic partials

    - evaluate the expression and then render the partial whose name is returned by this function

    ```js
    {{> (whichPartial) }}
    ```

- Point out how we are still utilizing Express to send data from the back-end to the front-end, but now we have provided `handlebars` as our templating engine.

- Handlebars is what is known as a "Semantic Templating" framework for JavaScript and HTML. Templating Engines like these are used as a replacement for constructing long strings of HTML within your JavaScript code, which will save us a lot of time and unnecessary work. They are a simpler method through which we can dynamically create or fill HTML elements.

- Open up your browser and navigate to the [NPM Express-handlbars](https://www.npmjs.com/package/express-handlebars#usage) to show them how simple the syntax for Handlebars is.

- Handlebars has a specific folder structure it expects to find, and will not function without it. It requires that you create a `views` folder within the root of your application, which contains all of your Handlebars files. It will also contain a `layouts` folder inside of `views`, which contains your `main.handlebars` file.

  - `main.handlebars` will be our default layout, where we will inject our views into.

- Open up the `04-HandlebarsLunch` folder once more in order to show your class how this folder system is constructed.

_Handlebars expects to find the views and layouts directories in specific locations._

- Open up `04-HandlebarsLunch/server.js` and direct them to `app.engine`.

  - Our first argument tells Express that our templating engine is going to be responsible for all files with the `handlebars` extension.

  - The second argument directs the templating engine to our `defaultLayout` which we have set as main. Because of this, handlebars will look for a `main.handlebars` inside of our `layouts` directory. `main.handlebars` will contain our primary layout of our HTML, and a `{{{body}}}` variable which our `views` will replace.

- Move onto the next line, `app.set`.

  - The first argument here lets express know we are setting our view engine. The next argument sets that view engine as `handlebars`.

- Open up `04-HandlebarsLunch/views/layouts/main.handlebars` and `04-HandlebarsLunch/views/index.handlebars` within your editor, and go over this code with your class.

- Start by showing your class how `04-HandlebarsLunch/views/layouts/main.handlebars` contains the declaration of our HTML and only seems to contain one Handlebars element in the form of `{{{ body }}}`. Explain how the usage of triple curly-brackets tells your program to read and render HTML elements while double curly-brackets will not.

_Our main layout contains a single Handlebars variable to interpolate._

- For Example, `{{{ <p> Hello World </p> }}}` would show up in our HTML as `<p>Hello World</p>` while, if we had used double curly-brackets, our code would look really ugly and come out as something like `&lt;p&gt;Hello World&lt;/p&gt;`.

- The `04-HandlebarsLunch/views/layouts/main.handlebars` code uses triple curly-brackets because we are going to be passing our other Handlebars components into it using statments like `res.render('index', lunches[1])` in our `04-HandlebarsLunch/server.js` file where `index` is a Handlebars component.

- Now turn your focus onto `04-HandlebarsLunch/views/index.handlebars` and discuss with your class how this file is taking in the variable `lunch` and is placing it with a pair of `<h1>` tags before sending that file into `04-HandlebarsLunch/views/layouts/main.handlebars` to be used. The method we use to pass the data into `04-HandlebarsLunch/views/index.handlebars` is just like any other Express statement.

### Partners Do: Explaining Lunches Application

- 840-50 (10 min)

- Slack out a zipped version of `04-HandlebarsLunch` to your students, have them open it up, and to those students around them, have them explain how the code functions. Once they are finished going over `main` and `index`, instruct them to look into `all-lunches` in an attempt to figure out how the code in there works as well.

- Tell them that, if they are lost or confused, the [Handlebars Website](http://handlebarsjs.com/) could be helpful in figuring the code out.

### Everyone Do: Explaining Lunches Cont. and the "Each" Helper

- 850-9 (10 min)

- Call on random students to explain the code to the rest of the class. Start with `04-HandlebarsLunch/views/layouts/main.handlebars`, `04-HandlebarsLunch/views/index.handlebars`, and `04-HandlebarsLunch/server.js` before having them move on to try and explain how `04-HandlebarsLunch/views/all-lunches.handlebars` functions.

- Open up `04-HandlebarsLunch/views/all-lunches.handlebars` within your editor, and go over the `{{#each foods}}` and `{{/each}}` statements in particular.

- The `{{#each}}` helper within Handlebars is essentially a for-loop which loops through an array and inserts the values of said array into your HTML code. It will do this for however many variables are contained within your array and will append your HTML instead of replacing it.

_Handlebars each blocks are analogous to for loops._

- There are other helpers which Handlebars uses, but we will be getting into those later on.

### Partners Do: Ben and Jerry's App

- 9-15 (15 min)

- Answer whatever questions your students may have and then slack out the following activity found in `05-BenAndJerrys/Solved/README.md` file.

# Instructions

- In this activity, you are going to be creating your own Ben and Jerry's App where users can see all of the different flavors Ben and Jerry's have to offer while also getting specific information on a flavor by searching for it within the URL.
  ```
  const icecreams = [
    {name: 'vanilla', price: 10, awesomeness: 3},
    {name: 'chocolate', price: 4, awesomeness: 8},
    {name: 'banana', price: 1, awesomeness: 1},
    {name: 'greentea', price: 5, awesomeness: 7},
    {name: 'jawbreakers', price: 6, awesomeness: 2},
  ];
  ```
- Do not use MySQL for this assignment! Use the `icecreams` variable above as your data. Add the variable to your `server.js` file.

- Using handlebars and express, create a route called `/icecreams/:name`. When the route is hit, it will display the name, price and awesomeness for that specific ice cream.

- Create an `/icecreams` route. It will loop over all the ice creams and display them all to the user.

### Everyone Do: Ben and Jerry's App Review

- 915-25 (10 min)

- Open up the `05-BenAndJerrys/Solved` folder within your editor.

- Go over the previous exercise with the class. Call on a unique student for each part of the previous exercise to explain what they did for their respective parts. If your class seemed to have struggled on a particular part of the activity, make sure to cover that section in more detail during this time.
